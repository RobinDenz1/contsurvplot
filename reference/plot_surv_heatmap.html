<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot a Heatmap of the Effect of a Continuous Covariate on a Time-To-Event Outcome — plot_surv_heatmap • contsurvplot</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a Heatmap of the Effect of a Continuous Covariate on a Time-To-Event Outcome — plot_surv_heatmap"><meta name="description" content="Using a previously fit time-to-event model, this function plots a heatmap with the continuous covariate on the y-axis and the time-to-event on the x-axis. The color is made in accordance with the corresponding survival probability or CIF at that point."><meta property="og:description" content="Using a previously fit time-to-event model, this function plots a heatmap with the continuous covariate on the y-axis and the time-to-event on the x-axis. The color is made in accordance with the corresponding survival probability or CIF at that point."><meta property="og:image" content="https://robindenz1.github.io/contsurvplot/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">contsurvplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Visualizing the Causal Effect of a Continuous Variable on a Time-To-Event Outcome</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RobinDenz1/contsurvplot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot a Heatmap of the Effect of a Continuous Covariate on a Time-To-Event Outcome</h1>

      <div class="d-none name"><code>plot_surv_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Using a previously fit time-to-event model, this function plots a heatmap with the continuous covariate on the y-axis and the time-to-event on the x-axis. The color is made in accordance with the corresponding survival probability or CIF at that point.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_surv_heatmap</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span>, <span class="va">variable</span>, group<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                  <span class="va">data</span>, <span class="va">model</span>, cif<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                  na.action<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">na.action</span>,</span>
<span>                  horizon<span class="op">=</span><span class="cn">NULL</span>, fixed_t<span class="op">=</span><span class="cn">NULL</span>, max_t<span class="op">=</span><span class="cn">Inf</span>,</span>
<span>                  start_color<span class="op">=</span><span class="cn">NULL</span>, end_color<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                  alpha<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="va">variable</span>,</span>
<span>                  title<span class="op">=</span><span class="cn">NULL</span>, subtitle<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                  legend.title<span class="op">=</span><span class="st">"S(t)"</span>, legend.position<span class="op">=</span><span class="st">"right"</span>,</span>
<span>                  gg_theme<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  facet_args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, panel_border<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                  axis_dist<span class="op">=</span><span class="fl">0</span>, interpolate<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                  contour_lines<span class="op">=</span><span class="cn">FALSE</span>, contour_color<span class="op">=</span><span class="st">"white"</span>,</span>
<span>                  contour_size<span class="op">=</span><span class="fl">0.3</span>, contour_linetype<span class="op">=</span><span class="st">"dashed"</span>,</span>
<span>                  <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>A single character string specifying the time-to-event variable. Needs to be a valid column name of a numeric variable in <code>data</code>.</p></dd>

  <dt id="arg-status">status<a class="anchor" aria-label="anchor" href="#arg-status"></a></dt>
<dd><p>A single character string specifying the status variable, indicating if a person has experienced an event or not. Needs to be a valid column name of a numeric or logical variable in <code>data</code>.</p></dd>

  <dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>A single character string specifying the continuous variable of interest, for which the survival curves should be estimated. This variable has to be contained in the <code>data.frame</code> that is supplied to the <code>data</code> argument.</p></dd>

  <dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>An optional single character string specifying a factor variable in <code>data</code>. When used, the plot is created conditional on this factor variable, meaning that a facetted plot is produced with one facet for each level of the factor variable. See <code><a href="curve_cont.html">curve_cont</a></code> for a detailed description of the estimation strategy. Set to <code>NULL</code> (default) to use no grouping variable.</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>data.frame</code> containing all required variables.</p></dd>

  <dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A model describing the time-to-event process (such as an <code>coxph</code> model). Needs to include <code>variable</code> as an independent variable. It also has to have an associated <code><a href="https://rdrr.io/pkg/riskRegression/man/predictRisk.html" class="external-link">predictRisk</a></code> method. See <code><a href="https://rdrr.io/pkg/riskRegression/man/predictRisk.html" class="external-link">?predictRisk</a></code> for more details.</p></dd>

  <dt id="arg-cif">cif<a class="anchor" aria-label="anchor" href="#arg-cif"></a></dt>
<dd><p>Whether to plot the cumulative incidence (CIF) instead of the survival probability. If multiple failure types are present, the survival probability cannot be estimated in an unbiased way. This function will always return CIF estimates in that case.</p></dd>

  <dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>How missing values should be handled. Can be one of: <code>na.fail</code>, <code>na.omit</code>, <code>na.pass</code>, <code>na.exclude</code> or a user-defined custom function. Also accepts strings of the function names. See <code><a href="https://rdrr.io/r/stats/na.action.html" class="external-link">?na.action</a></code> for more details. By default it uses the na.action which is set in the global options by the respective user.</p></dd>

  <dt id="arg-horizon">horizon<a class="anchor" aria-label="anchor" href="#arg-horizon"></a></dt>
<dd><p>A numeric vector containing a range of values of <code>variable</code> for which the survival curves should be calculated or <code>NULL</code> (default). If <code>NULL</code>, the horizon is constructed as a sequence from the lowest to the highest value observed in <code>variable</code> with 40 equally spaced steps.</p></dd>

  <dt id="arg-fixed-t">fixed_t<a class="anchor" aria-label="anchor" href="#arg-fixed-t"></a></dt>
<dd><p>A numeric vector containing points in time at which the survival probabilities should be calculated or <code>NULL</code> (default). If <code>NULL</code>, the survival probability is estimated at 100 equally spaced steps from 0 to the maximum observed event time.</p></dd>

  <dt id="arg-max-t">max_t<a class="anchor" aria-label="anchor" href="#arg-max-t"></a></dt>
<dd><p>A number indicating the latest survival time which is to be plotted.</p></dd>

  <dt id="arg-start-color">start_color<a class="anchor" aria-label="anchor" href="#arg-start-color"></a></dt>
<dd><p>The color used for the lowest value in <code>horizon</code>. This and the <code>end_color</code> argument can be used to specify custom continuous color scales used in the plot. For example, if a black and white plot is desired, the user can set <code>start_color="white"</code> and <code>end_color="black"</code>. See <code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">?scale_color_gradient</a></code> for more information.</p></dd>

  <dt id="arg-end-color">end_color<a class="anchor" aria-label="anchor" href="#arg-end-color"></a></dt>
<dd><p>The color used for the highest value in <code>horizon</code>. See argument <code>start_color</code>.</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The transparency level of the plot.</p></dd>

  <dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>A character string used as the x-axis label of the plot.</p></dd>

  <dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>A character string used as the y-axis label of the plot.</p></dd>

  <dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>A character string used as the title of the plot.</p></dd>

  <dt id="arg-subtitle">subtitle<a class="anchor" aria-label="anchor" href="#arg-subtitle"></a></dt>
<dd><p>A character string used as the subtitle of the plot.</p></dd>

  <dt id="arg-legend-title">legend.title<a class="anchor" aria-label="anchor" href="#arg-legend-title"></a></dt>
<dd><p>A character string used as the legend title of the plot.</p></dd>

  <dt id="arg-legend-position">legend.position<a class="anchor" aria-label="anchor" href="#arg-legend-position"></a></dt>
<dd><p>Where to put the legend. See <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">?theme</a></code> for more details.</p></dd>

  <dt id="arg-gg-theme">gg_theme<a class="anchor" aria-label="anchor" href="#arg-gg-theme"></a></dt>
<dd><p>A <span class="pkg">ggplot2</span> theme which is applied to the plot.</p></dd>

  <dt id="arg-facet-args">facet_args<a class="anchor" aria-label="anchor" href="#arg-facet-args"></a></dt>
<dd><p>A named list of arguments that are passed to the <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></code> function call when creating a plot separated by groups. Ignored if <code>group=NULL</code>. Any argument except the <code>facets</code> argument of the <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></code> function can be used. For example, if the user wants to allow free y-scales, this argument could be set to <code>list(scales="free_y")</code>.</p></dd>

  <dt id="arg-panel-border">panel_border<a class="anchor" aria-label="anchor" href="#arg-panel-border"></a></dt>
<dd><p>Whether to draw a border around the heatmap or not. Is set to FALSE by default to mimic standard heatmaps.</p></dd>

  <dt id="arg-axis-dist">axis_dist<a class="anchor" aria-label="anchor" href="#arg-axis-dist"></a></dt>
<dd><p>The distance of the axis ticks to the colored heatmap. Is set to 0 by default to mimic standard heatmaps.</p></dd>

  <dt id="arg-interpolate">interpolate<a class="anchor" aria-label="anchor" href="#arg-interpolate"></a></dt>
<dd><p>Whether to linearly interpolate the colors or not. Set to <code>TRUE</code> by default, which results in a smooth surface being plotted. Corresponds to the <code>interpolate</code> argument in the <code>geom_raster</code> function, which is used internally.</p></dd>

  <dt id="arg-contour-lines">contour_lines<a class="anchor" aria-label="anchor" href="#arg-contour-lines"></a></dt>
<dd><p>Whether to add some contour lines to the heatmap. To get a proper contour plot, use the <code><a href="plot_surv_contour.html">plot_surv_contour</a></code> function instead.</p></dd>

  <dt id="arg-contour-color">contour_color<a class="anchor" aria-label="anchor" href="#arg-contour-color"></a></dt>
<dd><p>The color of the contour lines. Defaults to <code>"white"</code>. Ignored if <code>contour_lines=FALSE</code>.</p></dd>

  <dt id="arg-contour-size">contour_size<a class="anchor" aria-label="anchor" href="#arg-contour-size"></a></dt>
<dd><p>The size of the contour lines. Ignored if <code>contour_lines=FALSE</code>.</p></dd>

  <dt id="arg-contour-linetype">contour_linetype<a class="anchor" aria-label="anchor" href="#arg-contour-linetype"></a></dt>
<dd><p>The linetype of the contour lines. Defaults to <code>"dashed"</code>. Ignored if <code>contour_lines=FALSE</code>.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to <code><a href="curve_cont.html">curve_cont</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Heatmaps are a great tool to visualize a three dimensional surface in a two-dimensional plot. A continuous color scale is used to represent the probability of interest. Although this is fine theoretically, it is often hard to read specific information off these plots. Contour lines can be added to the plot in order to make this easier by using <code>contour_lines=TRUE</code> in the function call.</p>
<p>In most cases, however, it is probably better to use a proper contour plot instead, which can be produced using the <code><a href="plot_surv_contour.html">plot_surv_contour</a></code> function. This is mostly a matter of taste, which is why both types of plots are included in this package. Another alternative is the to use the <code><a href="plot_surv_matrix.html">plot_surv_matrix</a></code> function, which is basically a discretized version of a survival heatmap.</p>
<p>The main advantage of the heatmap and the contour plots is that they can visualize the effect of a continuous covariate regardless of how it was modeled. Non-linear relationships can be visualized just as well as linear ones. The major downside is, that the structure of the plot is not the same as that of a standard Kaplan-Meier plot. An alternative that is closer to the standard plot can be created using the <code><a href="plot_surv_area.html">plot_surv_area</a></code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a <code>ggplot2</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Robin Denz</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RobinDenz1/contsurvplot" class="external-link">contsurvplot</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tagteam/riskRegression" class="external-link">riskRegression</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using data from the survival package</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">nafld</span>, package<span class="op">=</span><span class="st">"survival"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># take a random sample to keep example fast</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nafld1</span> <span class="op">&lt;-</span> <span class="va">nafld1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">nafld1</span><span class="op">)</span>, <span class="fl">150</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit cox-model with age</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span>, data<span class="op">=</span><span class="va">nafld1</span>, x<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot effect of age on survival using defaults</span></span></span>
<span class="r-in"><span><span class="fu">plot_surv_heatmap</span><span class="op">(</span>time<span class="op">=</span><span class="st">"futime"</span>,</span></span>
<span class="r-in"><span>                  status<span class="op">=</span><span class="st">"status"</span>,</span></span>
<span class="r-in"><span>                  variable<span class="op">=</span><span class="st">"age"</span>,</span></span>
<span class="r-in"><span>                  data<span class="op">=</span><span class="va">nafld1</span>,</span></span>
<span class="r-in"><span>                  model<span class="op">=</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_surv_heatmap-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot it only for 60 to 80 year old people</span></span></span>
<span class="r-in"><span><span class="fu">plot_surv_heatmap</span><span class="op">(</span>time<span class="op">=</span><span class="st">"futime"</span>,</span></span>
<span class="r-in"><span>                  status<span class="op">=</span><span class="st">"status"</span>,</span></span>
<span class="r-in"><span>                  variable<span class="op">=</span><span class="st">"age"</span>,</span></span>
<span class="r-in"><span>                  data<span class="op">=</span><span class="va">nafld1</span>,</span></span>
<span class="r-in"><span>                  model<span class="op">=</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>                  horizon<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_surv_heatmap-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## showing non-linear effects</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit cox-model with bmi modelled using B-Splines,</span></span></span>
<span class="r-in"><span><span class="co"># adjusting for age and sex</span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/splines/bs.html" class="external-link">bs</a></span><span class="op">(</span><span class="va">bmi</span>, df<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                data<span class="op">=</span><span class="va">nafld1</span>, x<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot effect of bmi on survival using defaults</span></span></span>
<span class="r-in"><span><span class="fu">plot_surv_heatmap</span><span class="op">(</span>time<span class="op">=</span><span class="st">"futime"</span>,</span></span>
<span class="r-in"><span>                  status<span class="op">=</span><span class="st">"status"</span>,</span></span>
<span class="r-in"><span>                  variable<span class="op">=</span><span class="st">"bmi"</span>,</span></span>
<span class="r-in"><span>                  data<span class="op">=</span><span class="va">nafld1</span>,</span></span>
<span class="r-in"><span>                  model<span class="op">=</span><span class="va">model2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_surv_heatmap-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot effect of bmi on survival with contour lines</span></span></span>
<span class="r-in"><span><span class="fu">plot_surv_heatmap</span><span class="op">(</span>time<span class="op">=</span><span class="st">"futime"</span>,</span></span>
<span class="r-in"><span>                  status<span class="op">=</span><span class="st">"status"</span>,</span></span>
<span class="r-in"><span>                  variable<span class="op">=</span><span class="st">"bmi"</span>,</span></span>
<span class="r-in"><span>                  data<span class="op">=</span><span class="va">nafld1</span>,</span></span>
<span class="r-in"><span>                  model<span class="op">=</span><span class="va">model2</span>,</span></span>
<span class="r-in"><span>                  contour_lines<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_surv_heatmap-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robin Denz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

