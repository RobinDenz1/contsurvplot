<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Using a previously fit time-to-event model, this function plots a single covariate-specific survival curve or CIF. Using either the plotly or the gganimate package, an animated plot is created that is either simply showing how the curve evolves over values of the continuous covariate, or includes a slide to let the user interact with it."><title>Create an Animated Plot of Survival Curves of CIFs as a Function of a Continuous Variable — plot_surv_animated • contsurvplot</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create an Animated Plot of Survival Curves of CIFs as a Function of a Continuous Variable — plot_surv_animated"><meta property="og:description" content="Using a previously fit time-to-event model, this function plots a single covariate-specific survival curve or CIF. Using either the plotly or the gganimate package, an animated plot is created that is either simply showing how the curve evolves over values of the continuous covariate, or includes a slide to let the user interact with it."><meta property="og:image" content="https://robindenz1.github.io/contsurvplot/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">contsurvplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">Visualizing the Causal Effect of a Continuous Variable on a Time-To-Event Outcome</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RobinDenz1/contsurvplot/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create an Animated Plot of Survival Curves of CIFs as a Function of a Continuous Variable</h1>
      
      <div class="d-none name"><code>plot_surv_animated.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Using a previously fit time-to-event model, this function plots a single covariate-specific survival curve or CIF. Using either the <span class="pkg">plotly</span> or the <span class="pkg">gganimate</span> package, an animated plot is created that is either simply showing how the curve evolves over values of the continuous covariate, or includes a slide to let the user interact with it.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_surv_animated</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span>, <span class="va">variable</span>, group<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                   <span class="va">data</span>, <span class="va">model</span>, cif<span class="op">=</span><span class="cn">FALSE</span>, conf_int<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                   conf_level<span class="op">=</span><span class="fl">0.95</span>, n_boot<span class="op">=</span><span class="fl">300</span>,</span>
<span>                   na.action<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">na.action</span>,</span>
<span>                   horizon<span class="op">=</span><span class="cn">NULL</span>, fixed_t<span class="op">=</span><span class="cn">NULL</span>, max_t<span class="op">=</span><span class="cn">Inf</span>,</span>
<span>                   slider<span class="op">=</span><span class="cn">TRUE</span>, size<span class="op">=</span><span class="fl">1</span>, color<span class="op">=</span><span class="st">"black"</span>,</span>
<span>                   linetype<span class="op">=</span><span class="st">"solid"</span>, alpha<span class="op">=</span><span class="fl">1</span>,</span>
<span>                   xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="st">"Survival Probability"</span>,</span>
<span>                   title<span class="op">=</span><span class="cn">NULL</span>, subtitle<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                   gg_theme<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   facet_args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, ci_alpha<span class="op">=</span><span class="fl">0.4</span>,</span>
<span>                   kaplan_meier<span class="op">=</span><span class="cn">FALSE</span>, km_size<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>                   km_linetype<span class="op">=</span><span class="st">"solid"</span>, km_alpha<span class="op">=</span><span class="fl">1</span>,</span>
<span>                   km_color<span class="op">=</span><span class="st">"black"</span>, km_ci<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                   km_ci_type<span class="op">=</span><span class="st">"plain"</span>, km_ci_level<span class="op">=</span><span class="fl">0.95</span>,</span>
<span>                   km_ci_alpha<span class="op">=</span><span class="fl">0.4</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>time</dt>
<dd><p>A single character string specifying the time-to-event variable. Needs to be a valid column name of a numeric variable in <code>data</code>.</p></dd>

  <dt>status</dt>
<dd><p>A single character string specifying the status variable, indicating if a person has experienced an event or not. Needs to be a valid column name of a numeric or logical variable in <code>data</code>.</p></dd>

  <dt>variable</dt>
<dd><p>A single character string specifying the continuous variable of interest, for which the survival curves should be estimated. This variable has to be contained in the <code>data.frame</code> that is supplied to the <code>data</code> argument.</p></dd>

  <dt>group</dt>
<dd><p>An optional single character string specifying a factor variable in <code>data</code>. When used, the plot is created conditional on this factor variable, meaning that a facetted plot is produced with one facet for each level of the factor variable. See <code><a href="curve_cont.html">curve_cont</a></code> for a detailed description of the estimation strategy. Set to <code>NULL</code> (default) to use no grouping variable.</p></dd>

  <dt>data</dt>
<dd><p>A <code>data.frame</code> containing all required variables.</p></dd>

  <dt>model</dt>
<dd><p>A model describing the time-to-event process (such as an <code>coxph</code> model). Needs to include <code>variable</code> as an independent variable. It also has to have an associated <code><a href="https://rdrr.io/pkg/riskRegression/man/riskRegression.html" class="external-link">predictRisk</a></code> method. See <code><a href="https://rdrr.io/pkg/riskRegression/man/predictRisk.html" class="external-link">?predictRisk</a></code> for more details.</p></dd>

  <dt>cif</dt>
<dd><p>Whether to plot the cumulative incidence (CIF) instead of the survival probability. If multiple failure types are present, the survival probability cannot be estimated in an unbiased way. This function will always return CIF estimates in that case.</p></dd>

  <dt>conf_int</dt>
<dd><p>Whether to plot point-wise bootstrap confidence intervals or not. Currently only supported when using <code>slider=FALSE</code>.</p></dd>

  <dt>conf_level</dt>
<dd><p>A number specifying the confidence level of the bootstrap confidence intervals. Ignored if <code>conf_int=FALSE</code>.</p></dd>

  <dt>n_boot</dt>
<dd><p>A single integer specifying how many bootstrap repetitions should be performed. Ignored if  <code>conf_int=FALSE</code>.</p></dd>

  <dt>na.action</dt>
<dd><p>How missing values should be handled. Can be one of: <code>na.fail</code>, <code>na.omit</code>, <code>na.pass</code>, <code>na.exclude</code> or a user-defined custom function. Also accepts strings of the function names. See <code><a href="https://rdrr.io/r/stats/na.action.html" class="external-link">?na.action</a></code> for more details. By default it uses the na.action which is set in the global options by the respective user.</p></dd>

  <dt>horizon</dt>
<dd><p>A numeric vector containing a range of values of <code>variable</code> for which the survival curves should be calculated or <code>NULL</code> (default). If <code>NULL</code>, the horizon is constructed as a sequence from the lowest to the highest value observed in <code>variable</code> with 40 equally spaced steps.</p></dd>

  <dt>fixed_t</dt>
<dd><p>A numeric vector containing points in time at which the survival probabilities should be calculated or <code>NULL</code> (default). If <code>NULL</code>, the survival probability is estimated at every point in time at which an event occurred.</p></dd>

  <dt>max_t</dt>
<dd><p>A number indicating the latest survival time which is to be plotted.</p></dd>

  <dt>slider</dt>
<dd><p>Whether to include a slider that controls the value of the continuous covariate or not. If not, the plot simply cycles through the values in <code>horizon</code> at a constant speed.</p></dd>

  <dt>size</dt>
<dd><p>A single number specifying the size of the drawn curve.</p></dd>

  <dt>color</dt>
<dd><p>A single character string specifying the color of the curve.</p></dd>

  <dt>linetype</dt>
<dd><p>A single character string specifying the linetype of the curve.</p></dd>

  <dt>alpha</dt>
<dd><p>The transparency level of the plot.</p></dd>

  <dt>xlab</dt>
<dd><p>A character string used as the x-axis label of the plot.</p></dd>

  <dt>ylab</dt>
<dd><p>A character string used as the y-axis label of the plot.</p></dd>

  <dt>title</dt>
<dd><p>A character string used as the title of the plot. When <code>slider=FALSE</code> is used, the title is also used in a dynamic way to show which value the continuous variable currently has. The user-defined title is still shown, but the covariate level is also appended to it in that case.</p></dd>

  <dt>subtitle</dt>
<dd><p>A character string used as the subtitle of the plot.</p></dd>

  <dt>gg_theme</dt>
<dd><p>A <span class="pkg">ggplot2</span> theme which is applied to the plot.</p></dd>

  <dt>facet_args</dt>
<dd><p>A named list of arguments that are passed to the <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></code> function call when creating a plot separated by groups. Ignored if <code>group=NULL</code>. Any argument except the <code>facets</code> argument of the <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></code> function can be used. For example, if the user wants to allow free y-scales, this argument could be set to <code>list(scales="free_y")</code>.</p></dd>

  <dt>ci_alpha</dt>
<dd><p>A single number defining the transparency level of the confidence interval bands.</p></dd>

  <dt>kaplan_meier</dt>
<dd><p>Whether to add a standard Kaplan-Meier estimator to the plot or not. If <code>group</code> is defined, the Kaplan-Meier estimator will be stratified by the grouping variable. If <code>cif=TRUE</code> was used, the cumulative incidence will be displayed instead of the survival curve.</p></dd>

  <dt>km_size</dt>
<dd><p>The size of the Kaplan-Meier line. Ignored if <code>kaplan_meier=FALSE</code>.</p></dd>

  <dt>km_linetype</dt>
<dd><p>The linetype of the Kaplan-Meier line. Ignored if <code>kaplan_meier=FALSE</code>.</p></dd>

  <dt>km_alpha</dt>
<dd><p>The transparency level of the Kaplan-Meier line. Ignored if <code>kaplan_meier=FALSE</code>.</p></dd>

  <dt>km_color</dt>
<dd><p>The color of the Kaplan-Meier line. Ignored if <code>kaplan_meier=FALSE</code>.</p></dd>

  <dt>km_ci</dt>
<dd><p>Whether to draw a confidence interval around the Kaplan-Meier estimates. Ignored if <code>kaplan_meier=FALSE</code>.</p></dd>

  <dt>km_ci_type</dt>
<dd><p>Which type of confidence interval to calculate for the Kaplan-Meier estimates. Corresponds to the <code>conf.type</code> argument in the <code>survfit</code> function. Ignored if <code>kaplan_meier=FALSE</code> or <code>km_ci=FALSE</code>.</p></dd>

  <dt>km_ci_level</dt>
<dd><p>Which confidence level to use for the confidence interval of the Kaplan-Meier estimates. Ignored if <code>kaplan_meier=FALSE</code> or <code>km_ci=FALSE</code>.</p></dd>

  <dt>km_ci_alpha</dt>
<dd><p>The transparency level of the confidence interval of the Kaplan-Meier estimates. Ignored if <code>kaplan_meier=FALSE</code> or <code>km_ci=FALSE</code>.</p></dd>

  <dt>...</dt>
<dd><p>Further arguments passed to <code><a href="curve_cont.html">curve_cont</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When the plot doesn't have to be on paper, it is also possible to use animation to represent how the survival curve or CIF changes when different values of a continuous covariate are used. There are two options included in this function. The first one is creating a plot with a slider that can be interactively manipulated by the user (argument <code>slider=TRUE</code>). The second option creates a .gif file in which the continuous variable changes constantly over time (argument <code>slider=FALSE</code>).</p>
<p>This type of plot is only useful when visualizing the effect on a computer. It is also important to keep in mind that these plots might look slightly different to users with different hardware and or software.</p>
<p>An additional interactive plot can be created using the <code><a href="plot_surv_3Dsurface.html">plot_surv_3Dsurface</a></code> function with <code>interactive=TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a <code>plotly</code> object if <code>slider=TRUE</code> and a <code>gganim</code> object if <code>slider=FALSE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Robin Denz</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RobinDenz1/contsurvplot" class="external-link">contsurvplot</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tagteam/riskRegression" class="external-link">riskRegression</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gganimate.com" class="external-link">gganimate</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No renderer backend detected. gganimate will default to writing frames to separate files</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Consider installing:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> - the `gifski` package for gif output</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> - the `av` package for video output</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> and restarting the R session</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/thomasp85/transformr" class="external-link">transformr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com" class="external-link">plotly</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using data from the survival package</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">nafld</span>, package<span class="op">=</span><span class="st">"survival"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># take a random sample to keep example fast</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nafld1</span> <span class="op">&lt;-</span> <span class="va">nafld1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">nafld1</span><span class="op">)</span>, <span class="fl">150</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit cox-model with age</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span>, data<span class="op">=</span><span class="va">nafld1</span>, x<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># plot effect of age on survival for ages 50 to 80</span></span></span>
<span class="r-in"><span><span class="fu">plot_surv_animated</span><span class="op">(</span>time<span class="op">=</span><span class="st">"futime"</span>,</span></span>
<span class="r-in"><span>                   status<span class="op">=</span><span class="st">"status"</span>,</span></span>
<span class="r-in"><span>                   variable<span class="op">=</span><span class="st">"age"</span>,</span></span>
<span class="r-in"><span>                   data<span class="op">=</span><span class="va">nafld1</span>,</span></span>
<span class="r-in"><span>                   model<span class="op">=</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>                   horizon<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">80</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   slider<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot effect of age on survival using an interactive plot for ages 50 to 80</span></span></span>
<span class="r-in"><span><span class="fu">plot_surv_animated</span><span class="op">(</span>time<span class="op">=</span><span class="st">"futime"</span>,</span></span>
<span class="r-in"><span>                   status<span class="op">=</span><span class="st">"status"</span>,</span></span>
<span class="r-in"><span>                   variable<span class="op">=</span><span class="st">"age"</span>,</span></span>
<span class="r-in"><span>                   data<span class="op">=</span><span class="va">nafld1</span>,</span></span>
<span class="r-in"><span>                   model<span class="op">=</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>                   horizon<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">80</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   slider<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## showing non-linear effects</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit cox-model with bmi modeled using B-Splines,</span></span></span>
<span class="r-in"><span><span class="co"># adjusting for age and sex</span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/splines/bs.html" class="external-link">bs</a></span><span class="op">(</span><span class="va">bmi</span>, df<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                data<span class="op">=</span><span class="va">nafld1</span>, x<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># plot effect of bmi on survival using slider</span></span></span>
<span class="r-in"><span><span class="fu">plot_surv_animated</span><span class="op">(</span>time<span class="op">=</span><span class="st">"futime"</span>,</span></span>
<span class="r-in"><span>                   status<span class="op">=</span><span class="st">"status"</span>,</span></span>
<span class="r-in"><span>                   variable<span class="op">=</span><span class="st">"bmi"</span>,</span></span>
<span class="r-in"><span>                   data<span class="op">=</span><span class="va">nafld1</span>,</span></span>
<span class="r-in"><span>                   model<span class="op">=</span><span class="va">model2</span>,</span></span>
<span class="r-in"><span>                   slider<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot effect of bmi on survival using a .gif</span></span></span>
<span class="r-in"><span><span class="fu">plot_surv_animated</span><span class="op">(</span>time<span class="op">=</span><span class="st">"futime"</span>,</span></span>
<span class="r-in"><span>                   status<span class="op">=</span><span class="st">"status"</span>,</span></span>
<span class="r-in"><span>                   variable<span class="op">=</span><span class="st">"bmi"</span>,</span></span>
<span class="r-in"><span>                   data<span class="op">=</span><span class="va">nafld1</span>,</span></span>
<span class="r-in"><span>                   model<span class="op">=</span><span class="va">model2</span>,</span></span>
<span class="r-in"><span>                   slider<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Robin Denz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

